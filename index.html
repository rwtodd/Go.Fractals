<html>
<head><title>Fractals-Go</title>
<link rel="stylesheet" type="text/css" href="fract.css">
<script type="text/javascript">
function zoompan(event) {
  // for now, just pan.
  var form = document.getElementById("userInput").elements;

  var fimg = document.getElementById("picture").getBoundingClientRect();
  var deltaX = (event.clientX - fimg.left - (fimg.width/2.0)) / fimg.width;
  var deltaY = -(event.clientY - fimg.top  - (fimg.height/2.0)) / fimg.height;

  var spanX = parseFloat(form['spX'].value);
  var spanY = parseFloat(form['spX'].value);
  form['cX'].value =  parseFloat(form['cX'].value) + deltaX * spanX;
  form['cY'].value =  parseFloat(form['cY'].value) + deltaY * spanY;

  var clickaction = form['clicking'].value
  if(clickaction == "In") {
    form['spX'].value = spanX/2.0; 
    form['spY'].value = spanY/2.0; 
  } else if(clickaction == "Out") {
    form['spX'].value = spanX*2.0; 
    form['spY'].value = spanY*2.0; 
  }

  draw();
}

function reset() {
   var form = document.getElementById("userInput").elements
   form['width'].value = '600';
   form['height'].value = '600';
   form['depth'].value = '256';
   form['cX'].value = '0.0';
   form['cY'].value = '0.0';
   form['spX'].value = '3';
   form['spY'].value = '3';
   draw();
}

function draw() {
   var form = document.getElementById("userInput").elements;
   document.getElementById("picture").src = '/img' + 
       "?fractal=" + form['fractal'].value +
       "&depth=" + form['depth'].value +
       "&creal=" + form['creal'].value +
       "&cimag=" + form['cimag'].value +
       "&esc=" + form['esc'].value +
       "&cX=" + form['cX'].value +
       "&cY=" + form['cY'].value +
       "&spX=" + form['spX'].value +
       "&spY=" + form['spY'].value +
       "&width=" + form['width'].value +
       "&height=" + form['height'].value; 
} 
</script>
</head>
<body>
<div id="controls"> 
<h1>Fractals</h1>
<form id="userInput"> 
<fieldset>
<legend>Fractal</legend>
<label>Algorithm:</label>
        <select name="fractal">
           <option value="Mandelbrot">Mandelbrot</option>
           <option value="JuliaSq">Julia: x^2 + c</option>
           <option value="JuliaExp">Julia e^x + c</option>
           <option value="JuliaZExp">Julia x*e^x + c</option>
        </select><br>
<label>C:</label>
   <span class="inputs">
       <input type="number" name="creal" value="0.0" step="0.00001"> + 
       <input type="number" name="cimag" value="0.0" step="0.00001"> i
   </span><br>
<label>Escapes:</label><input type="number" name="esc" value="4.0" step="1"> 
</fieldset>
<fieldset>
  <legend>Image</legend>
   <label>Size:</label><input type="number" name="width" value="600"> x 
                       <input type="number" name="height" value="600"><br>
   <label>Depth:</label><input type="number" name="depth" value="256">
</fieldset>
<fieldset>
  <legend>Location</legend>
  <label>Center:</label>
   <span class="inputs">
        <input type="number" name="cX" value="0.0" step="0.00001"> + 
        <input type="number" name="cY" value="0.0" step="0.00001"> i
   </span><br>
  <label>Span:</label>
   <span class="inputs">
        <input type="number" name="spX" value="3.0" step="0.000001">, 
        <input type="number" name="spY" value="3.0" step="0.000001">
  </span>
</fieldset>
<fieldset>
  <legend>Clicking On Image</legend>
  <input type="radio" name="clicking" value="In">Zoom In&nbsp;&nbsp;
  <input type="radio" name="clicking" value="Out">Zoom Out&nbsp;&nbsp;
  <input type="radio" checked="true" name="clicking" value="Pan">Pan
</fieldset>
</form>
<button onclick="draw()">Draw</button>
<button onclick="reset()">Reset</button>
</div>
<div id="fract">
   <img id="picture" onclick="zoompan(event)" src="/img">
</div>
</body>
</html>
